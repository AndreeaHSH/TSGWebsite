<!-- Success Notification Overlay -->
<div *ngIf="showSuccessNotification"
     class="success-notification-overlay"
     [@successNotification]>
  <div class="success-notification">
    <div class="success-icon">
      <i class="fas fa-check-circle"></i>
    </div>
    <h3 class="success-title">Aplicația a fost trimisă cu succes!</h3>
    <p class="success-message">
      Mulțumim pentru aplicație! Te vom contacta în cel mai scurt timp cu detalii despre următorii pași.
    </p>
    <div class="success-actions">
      <button class="btn-primary" (click)="closeSuccessNotification()">
        Întoarce-te la pagina principală
      </button>
    </div>
    <div class="success-countdown">
      Vei fi redirecționat automat în câteva secunde...
    </div>
  </div>
</div>

<main class="site-main">
  <section class="application-section">
    <div class="section-container">
      <div class="form-header" [@slideInUp]>
        <h2 class="section-title">Aplicare Voluntariat TSG</h2>
        <p class="form-description">
          Completează formularul de mai jos pentru a aplica ca voluntar în echipa Transilvania Star Group.
          Te vom contacta în cel mai scurt timp cu detalii despre următorii pași.
        </p>
      </div>

      <div class="application-form-container" [@slideInUp]>
        <form [formGroup]="applicationForm" (ngSubmit)="onSubmit()" class="application-form">

          <!-- Personal Information -->
          <fieldset class="form-section" [@slideInUp]>
            <legend class="section-legend">Informații Personale</legend>

            <div class="form-row">
              <div class="form-group">
                <label for="firstName" class="form-label">
                  Prenume<span class="required-asterisk">*</span>
                </label>
                <input
                  type="text"
                  id="firstName"
                  formControlName="firstName"
                  class="form-input"
                  [class.invalid]="isFieldInvalid('firstName')">
                <div *ngIf="isFieldInvalid('firstName')" class="error-message">
                  {{ getFieldError('firstName') }}
                </div>
              </div>
              <div class="form-group">
                <label for="lastName" class="form-label">
                  Nume<span class="required-asterisk">*</span>
                </label>
                <input
                  type="text"
                  id="lastName"
                  formControlName="lastName"
                  class="form-input"
                  [class.invalid]="isFieldInvalid('lastName')">
                <div *ngIf="isFieldInvalid('lastName')" class="error-message">
                  {{ getFieldError('lastName') }}
                </div>
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="email" class="form-label">
                  Email<span class="required-asterisk">*</span>
                </label>
                <input
                  type="email"
                  id="email"
                  formControlName="email"
                  class="form-input"
                  [class.invalid]="isFieldInvalid('email')">
                <div *ngIf="isFieldInvalid('email')" class="error-message">
                  {{ getFieldError('email') }}
                </div>
              </div>
              <div class="form-group">
                <label for="phone" class="form-label">
                  Telefon<span class="required-asterisk">*</span>
                </label>
                <input
                  type="tel"
                  id="phone"
                  formControlName="phone"
                  class="form-input"
                  [class.invalid]="isFieldInvalid('phone')">
                <div *ngIf="isFieldInvalid('phone')" class="error-message">
                  {{ getFieldError('phone') }}
                </div>
              </div>
            </div>

            <div class="form-group">
              <label for="birthDate" class="form-label">
                Data de naștere<span class="required-asterisk">*</span>
              </label>
              <input
                type="date"
                id="birthDate"
                formControlName="birthDate"
                class="form-input"
                [class.invalid]="isFieldInvalid('birthDate')">
              <div *ngIf="isFieldInvalid('birthDate')" class="error-message">
                {{ getFieldError('birthDate') }}
              </div>
            </div>
          </fieldset>

          <!-- Academic Information -->
          <fieldset class="form-section" [@slideInUp]>
            <legend class="section-legend">Informații Academice</legend>

            <div class="form-row">
              <div class="form-group">
                <label for="faculty" class="form-label">
                  Facultatea<span class="required-asterisk">*</span>
                </label>
                <select
                  id="faculty"
                  formControlName="faculty"
                  class="form-select"
                  [class.invalid]="isFieldInvalid('faculty')">
                  <option value="">Selectează facultatea</option>
                  <option *ngFor="let faculty of facultyOptions" [value]="faculty.value">
                    {{ faculty.label }}
                  </option>
                </select>
                <div *ngIf="isFieldInvalid('faculty')" class="error-message">
                  {{ getFieldError('faculty') }}
                </div>
              </div>
              <div class="form-group">
                <label for="specialization" class="form-label">
                  Specializarea<span class="required-asterisk">*</span>
                </label>
                <input
                  type="text"
                  id="specialization"
                  formControlName="specialization"
                  class="form-input"
                  placeholder="ex: Informatică, Calculatoare, etc."
                  [class.invalid]="isFieldInvalid('specialization')">
                <div *ngIf="isFieldInvalid('specialization')" class="error-message">
                  {{ getFieldError('specialization') }}
                </div>
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="studyYear" class="form-label">
                  Anul de studiu<span class="required-asterisk">*</span>
                </label>
                <select
                  id="studyYear"
                  formControlName="studyYear"
                  class="form-select"
                  [class.invalid]="isFieldInvalid('studyYear')">
                  <option value="">Selectează anul</option>
                  <option *ngFor="let year of yearOptions" [value]="year.value">
                    {{ year.label }}
                  </option>
                </select>
                <div *ngIf="isFieldInvalid('studyYear')" class="error-message">
                  {{ getFieldError('studyYear') }}
                </div>
              </div>
              <div class="form-group">
                <label for="studentId" class="form-label">
                  Numărul matricol
                </label>
                <input
                  type="text"
                  id="studentId"
                  formControlName="studentId"
                  class="form-input"
                  placeholder="ex: 123456">
              </div>
            </div>
          </fieldset>

          <!-- Role Preferences -->
          <fieldset class="form-section" [@slideInUp]>
            <legend class="section-legend">Preferințe Rol</legend>

            <div class="form-row">
              <div class="form-group">
                <label for="preferredRole" class="form-label">
                  Rolul preferat<span class="required-asterisk">*</span>
                </label>
                <select
                  id="preferredRole"
                  formControlName="preferredRole"
                  class="form-select"
                  [class.invalid]="isFieldInvalid('preferredRole')">
                  <option value="">Selectează rolul preferat</option>
                  <option *ngFor="let role of roleOptions" [value]="role.value">
                    {{ role.label }}
                  </option>
                </select>
                <div *ngIf="isFieldInvalid('preferredRole')" class="error-message">
                  {{ getFieldError('preferredRole') }}
                </div>
              </div>
              <div class="form-group">
                <label for="alternativeRole" class="form-label">
                  Rol alternativ
                </label>
                <select
                  id="alternativeRole"
                  formControlName="alternativeRole"
                  class="form-select">
                  <option value="">Selectează rol alternativ</option>
                  <option *ngFor="let role of roleOptions" [value]="role.value">
                    {{ role.label }}
                  </option>
                </select>
              </div>
            </div>
          </fieldset>

          <!-- Technical Skills -->
          <fieldset class="form-section" [@slideInUp]>
            <legend class="section-legend">Competențe Tehnice</legend>

            <div class="form-group">
              <label for="programmingLanguages" class="form-label">Limbaje de programare</label>
              <input
                type="text"
                id="programmingLanguages"
                formControlName="programmingLanguages"
                class="form-input"
                placeholder="ex: JavaScript, Python, Java, C#, PHP">
            </div>

            <div class="form-group">
              <label for="frameworks" class="form-label">Framework-uri și biblioteci</label>
              <input
                type="text"
                id="frameworks"
                formControlName="frameworks"
                class="form-input"
                placeholder="ex: React, Angular, .NET, Django, Laravel">
            </div>

            <div class="form-group">
              <label for="tools" class="form-label">Tools și tehnologii</label>
              <input
                type="text"
                id="tools"
                formControlName="tools"
                class="form-input"
                placeholder="ex: Git, Docker, VS Code, Figma, Adobe Creative Suite">
            </div>
          </fieldset>

          <!-- Experience and Motivation -->
          <fieldset class="form-section" [@slideInUp]>
            <legend class="section-legend">Experiență și Motivație</legend>

            <div class="form-group">
              <label for="experience" class="form-label">Experiența anterioară</label>
              <textarea
                id="experience"
                formControlName="experience"
                class="form-textarea"
                rows="4"
                placeholder="Descrie experiența ta anterioară (proiecte, internship-uri, etc.)">
              </textarea>
            </div>

            <div class="form-group">
              <label for="motivation" class="form-label">
                Motivația pentru a te alătura TSG<span class="required-asterisk">*</span>
              </label>
              <textarea
                id="motivation"
                formControlName="motivation"
                class="form-textarea"
                rows="5"
                placeholder="Explică motivația ta pentru a deveni voluntar în TSG (minimum 100 caractere)"
                [class.invalid]="isFieldInvalid('motivation')">
              </textarea>
              <div *ngIf="isFieldInvalid('motivation')" class="error-message">
                {{ getFieldError('motivation') }}
              </div>
            </div>

            <div class="form-group">
              <label for="contribution" class="form-label">
                Cum poți contribui la TSG<span class="required-asterisk">*</span>
              </label>
              <textarea
                id="contribution"
                formControlName="contribution"
                class="form-textarea"
                rows="4"
                placeholder="Descrie cum vei contribui la dezvoltarea și succesul TSG"
                [class.invalid]="isFieldInvalid('contribution')">
              </textarea>
              <div *ngIf="isFieldInvalid('contribution')" class="error-message">
                {{ getFieldError('contribution') }}
              </div>
            </div>
          </fieldset>

          <!-- Availability -->
          <fieldset class="form-section" [@slideInUp]>
            <legend class="section-legend">Disponibilitate</legend>

            <div class="form-group">
              <label for="timeCommitment" class="form-label">
                Timpul pe care îl poți dedica<span class="required-asterisk">*</span>
              </label>
              <select
                id="timeCommitment"
                formControlName="timeCommitment"
                class="form-select"
                [class.invalid]="isFieldInvalid('timeCommitment')">
                <option value="">Selectează timpul disponibil</option>
                <option *ngFor="let time of timeCommitmentOptions" [value]="time.value">
                  {{ time.label }}
                </option>
              </select>
              <div *ngIf="isFieldInvalid('timeCommitment')" class="error-message">
                {{ getFieldError('timeCommitment') }}
              </div>
            </div>

            <div class="form-group">
              <label for="schedule" class="form-label">Programul preferat</label>
              <textarea
                id="schedule"
                formControlName="schedule"
                class="form-textarea"
                rows="3"
                placeholder="Descrie programul în care ești disponibil (zile, ore, etc.)">
              </textarea>
            </div>
          </fieldset>

          <!-- Documents and Portfolio -->
          <fieldset class="form-section" [@slideInUp]>
            <legend class="section-legend">Documente și Portofoliu</legend>

            <div class="form-group">
              <label for="portfolioUrl" class="form-label">Link către portofoliu/GitHub</label>
              <input
                type="url"
                id="portfolioUrl"
                formControlName="portfolioUrl"
                class="form-input"
                placeholder="https://github.com/username sau link către portofoliu">
            </div>

            <div class="form-group">
              <label for="cv" class="form-label">CV (PDF, max 5MB)</label>
              <div class="file-upload-area">
                <input
                  type="file"
                  id="cv"
                  accept=".pdf"
                  (change)="onFileSelected($event)">
                <p>Selectează sau trage fișierul aici</p>
                <div *ngIf="selectedFile" class="selected-file">
                  Fișier selectat: {{ selectedFile.name }}
                </div>
              </div>
            </div>
          </fieldset>

          <!-- Terms and Conditions -->
          <fieldset class="form-section" [@slideInUp]>
            <legend class="section-legend">Termeni și Condiții</legend>

            <div class="checkbox-group">
              <div class="checkbox-item">
                <input
                  type="checkbox"
                  id="termsAgreement"
                  formControlName="termsAgreement"
                  [class.invalid]="isFieldInvalid('termsAgreement')">
                <label for="termsAgreement" class="checkbox-label">
                  Sunt de acord cu termenii și condițiile TSG<span class="required-asterisk">*</span>
                </label>
              </div>
              <div *ngIf="isFieldInvalid('termsAgreement')" class="error-message">
                {{ getFieldError('termsAgreement') }}
              </div>
            </div>

            <div class="checkbox-group">
              <div class="checkbox-item">
                <input
                  type="checkbox"
                  id="gdprAgreement"
                  formControlName="gdprAgreement"
                  [class.invalid]="isFieldInvalid('gdprAgreement')">
                <label for="gdprAgreement" class="checkbox-label">
                  Consimț la prelucrarea datelor personale în conformitate cu GDPR<span class="required-asterisk">*</span>
                </label>
              </div>
              <div *ngIf="isFieldInvalid('gdprAgreement')" class="error-message">
                {{ getFieldError('gdprAgreement') }}
              </div>
            </div>
          </fieldset>

          <!-- Submit Section -->
          <div class="form-submit-section" [@slideInUp]>
            <button
              type="submit"
              class="form-submit"
              [disabled]="isSubmitting">
              {{ isSubmitting ? 'Se trimite...' : 'Trimite Aplicația' }}
            </button>

            <p class="submit-note">
              Prin trimiterea acestui formular, confirmați că toate informațiile furnizate sunt corecte și complete.
            </p>

            <div *ngIf="submitMessage" class="submit-message"
                 [ngClass]="{'success': submitMessage.includes('succes'), 'error': submitMessage.includes('eroare')}">
              {{ submitMessage }}
            </div>
          </div>

        </form>
      </div>
    </div>
  </section>
</main>
