<!-- PublicWebsite/src/app/pages/blog/blog.html -->
<main class="site-main">
  <section class="blog-section">
    <div class="section-container">

      <!-- Blog Header -->
      <div class="blog-header">
        <h2 class="section-title">Blog Transilvania Star Group</h2>
        <p class="blog-description">
          Descoperă ultimele noutăți, articole tehnice și povești din spatele proiectelor noastre.
          Urmărește evoluția TSG și învață din experiențele echipei noastre.
        </p>
      </div>

      <!-- Loading State -->
      <div *ngIf="isLoading" class="loading-container">
        <div class="loading-spinner"></div>
        <p class="loading-text">Se încarcă postările...</p>
      </div>

      <!-- Error State -->
      <div *ngIf="error && !isLoading" class="error-container">
        <div class="error-icon">⚠️</div>
        <h3 class="error-title">Eroare la încărcarea blogului</h3>
        <p class="error-message">{{ error }}</p>
        <button class="retry-btn" (click)="retryLoad()">
          Încearcă din nou
        </button>
      </div>

      <!-- Blog Content -->
      <div *ngIf="!isLoading && !error">

        <!-- Featured Post -->
        <div *ngIf="featuredPost" class="featured-post" (click)="navigateToPost(featuredPost)">
          <div class="post-image" *ngIf="featuredPost.featuredImage">
            <img
              [src]="getPrimaryImage(featuredPost)"
              [alt]="featuredPost.title"
              class="post-img"
              (error)="onImageError($event)"
              loading="lazy">
            <div *ngIf="hasImages(featuredPost) && featuredPost.imageCount > 1" class="image-count-badge">
              +{{ featuredPost.imageCount - 1 }} imagini
            </div>
          </div>

          <div class="post-content">
            <div class="post-meta">
              <span class="post-date">{{ formatDate(featuredPost.publishedAt) }}</span>
              <span class="reading-time">{{ getReadingTimeText(featuredPost.readingTime) }}</span>
              <span class="post-author">de {{ featuredPost.author }}</span>
            </div>

            <h3 class="post-title">{{ featuredPost.title }}</h3>

            <p class="post-excerpt">
              {{ truncateText(featuredPost.summary, 300) }}
            </p>

            <div *ngIf="parseTags(featuredPost.tags).length > 0" class="post-tags">
              <span
                *ngFor="let tag of parseTags(featuredPost.tags); trackBy: trackByTag"
                class="tag"
                (click)="navigateToTag(tag); $event.stopPropagation()">
                {{ tag }}
              </span>
            </div>
          </div>
        </div>

        <!-- Blog Posts Grid -->
        <div *ngIf="blogPosts.length > 0" class="blog-posts-section">
          <h3 class="posts-section-title">Alte articole</h3>

          <div class="blog-posts-grid">
            <div
              *ngFor="let post of blogPosts; trackBy: trackByPostId"
              class="blog-post-card"
              (click)="navigateToPost(post)">

              <div class="post-image" *ngIf="post.featuredImage">
                <img
                  [src]="getPrimaryImage(post)"
                  [alt]="post.title"
                  class="post-img"
                  (error)="onImageError($event)"
                  loading="lazy">
                <div *ngIf="hasImages(post) && post.imageCount > 1" class="image-count-badge">
                  +{{ post.imageCount - 1 }}
                </div>
              </div>

              <div class="card-content">
                <div class="post-meta">
                  <span class="post-date">{{ formatDate(post.publishedAt) }}</span>
                  <span class="reading-time">{{ getReadingTimeText(post.readingTime) }}</span>
                </div>

                <h4 class="post-title">{{ post.title }}</h4>

                <p class="post-excerpt">
                  {{ truncateText(post.summary, 120) }}
                </p>

                <div *ngIf="parseTags(post.tags).length > 0" class="post-tags">
                  <span
                    *ngFor="let tag of parseTags(post.tags); trackBy: trackByTag"
                    class="tag"
                    (click)="navigateToTag(tag); $event.stopPropagation()">
                    {{ tag }}
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Blog Categories/Tags -->
        <div *ngIf="allTags.length > 0" class="blog-categories">
          <h3 class="categories-title">Explorează după categorii</h3>
          <div class="categories-grid">
            <button
              *ngFor="let tag of allTags; trackBy: trackByTag"
              class="category-link"
              (click)="navigateToTag(tag)">
              <span class="category-name">{{ tag }}</span>
            </button>
          </div>
        </div>

        <!-- Empty State -->
        <div *ngIf="!featuredPost && blogPosts.length === 0" class="empty-state">
          <div class="empty-icon">📝</div>
          <h3 class="empty-title">În curând vor apărea articole</h3>
          <p class="empty-message">
            Echipa TSG lucrează la conținut interesant pentru tine.
            Urmărește această pagină pentru ultimele noutăți!
          </p>
        </div>

      </div>

    </div>
  </section>
</main>
